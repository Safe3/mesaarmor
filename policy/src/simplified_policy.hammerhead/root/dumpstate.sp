{
domain_name dumpstate : netdomain,mlstrustedsubject;
domain_trans init /system/bin/dumpstate;
domain_trans su /system/bin/dumpstate;
  
  allow /data/** r,w,s,x;
  allow /data/anr/** r,w,s,x;
  allow /data/app/[^/]+/oat/** r,w,s,x;
  allow /data/app/vmdl[^/]+\.tmp/oat/** r,w,s,x;
  allow /data/dalvik-cache/** r,w,s,x;
  allow /data/local/tmp/** r,w,s,x;
  allow /data/misc/net/** r,w,x,s;
  allow /data/tombstones/** r,w,s,x;
  allow /dev/ashmem r,x,s;
  allow /dev/kgsl r,w,x,s;
  allow /dev/kgsl-3d0 r,w,x,s;
  allow /dev/pts r,w,x,s;
  allow /dev/pvrsrvkm r,w,x,s;
  allow /dev/socket/logd r,w,s;
  allow /dev/socket/logdr r,w,s;
  allow /mnt/expand/[^/]+/** r,w,s,x;
  allow /mnt/expand/[^/]+/app/[^/]+/oat/** r,w,s,x;
  allow /mnt/expand/[^/]+/app/vmdl[^/]+\.tmp/oat/** r,w,s,x;
  allow /mnt/expand/[^/]+/local/tmp/** r,w,s,x;
  allow /mnt/runtime/** s;
  allow /odm/** r,x,s;
  allow /proc/net/xt_qtaguid/ctrl r,w,x,s;
  allow /storage/** s;
  allow /sys/** r,w,x,s;
  allow /system/** r,x,s;
  allow /system/bin/app_process32 r,w,x,s;
  allow /system/bin/app_process64 r,w,x,s;
  allow /system/bin/dumpstate r,w,x,s;
  allow /system/bin/logcat r,w,x,s;
  allow /system/bin/logwrapper r,x,s;
  allow /system/bin/sh r,w,x,s;
  allow /system/bin/toolbox r,w,x,s;
  allow /system/bin/toybox r,w,x,s;
  allow /system/bin/vdc r,w,x,s;
  allow /system/xbin/procrank r,w,x,s;
  allow /system/xbin/simpleperf r,x,s;
  allow /system/xbin/su r,w,x,s;
  allow /vendor/** r,x,s;
  allowbinder bluetooth c ;
  allowbinder drmserver c ;
  allowbinder gatekeeperd c ;
  allowbinder healthd c ;
  allowbinder inputflinger c ;
  allowbinder isolated_app c ;
  allowbinder keystore c ;
  allowbinder mediaserver c ;
  allowbinder nfc c ;
  allowbinder platform_app c ;
  allowbinder radio c ;
  allowbinder servicemanager c ;
  allowbinder shared_relro c ;
  allowbinder shell c ;
  allowbinder su c ;
  allowbinder surfaceflinger c ;
  allowbinder surfaceflinger t ;
  allowbinder system_app c ;
  allowbinder system_server c ;
  allowbinder system_server t ;
  allowbinder untrusted_app c ;
  allowcom -ipc dumpstate r; #allow dumpstate dumpstate:fifo_file { read lock getattr write ioctl open append };
  allowcom -ipc dumpstate r; #allow dumpstate dumpstate:unix_dgram_socket { setopt setattr read lock create sendto getattr write ioctl connect shutdown bind getopt append };
  allowcom -ipc dumpstate r; #allow dumpstate dumpstate:unix_stream_socket { connectto setopt setattr read lock create getattr accept write ioctl connect shutdown bind getopt append listen };
  allowcom -ipc dumpstate w; #allow dumpstate dumpstate:fifo_file { read lock getattr write ioctl open append };
  allowcom -ipc dumpstate w; #allow dumpstate dumpstate:unix_dgram_socket { setopt setattr read lock create sendto getattr write ioctl connect shutdown bind getopt append };
  allowcom -ipc dumpstate w; #allow dumpstate dumpstate:unix_stream_socket { connectto setopt setattr read lock create getattr accept write ioctl connect shutdown bind getopt append listen };
  allowcom -ipc logd w; #allow dumpstate logd:unix_stream_socket connectto;
  allowcom -sig appdomain o; #allow dumpstate appdomain:process signal;
  allowcom -sig drmserver o; #allow dumpstate drmserver:process signal;
  allowcom -sig dumpstate c; #allow dumpstate dumpstate:process { fork getsession sigkill sigchld setpgid setsched signal getattr setcap sigstop execmem getcap getpgid getsched signull setrlimit };
  allowcom -sig dumpstate k; #allow dumpstate dumpstate:process { fork getsession sigkill sigchld setpgid setsched signal getattr setcap sigstop execmem getcap getpgid getsched signull setrlimit };
  allowcom -sig dumpstate n; #allow dumpstate dumpstate:process { fork getsession sigkill sigchld setpgid setsched signal getattr setcap sigstop execmem getcap getpgid getsched signull setrlimit };
  allowcom -sig dumpstate o; #allow dumpstate dumpstate:process { fork getsession sigkill sigchld setpgid setsched signal getattr setcap sigstop execmem getcap getpgid getsched signull setrlimit };
  allowcom -sig dumpstate s; #allow dumpstate dumpstate:process { fork getsession sigkill sigchld setpgid setsched signal getattr setcap sigstop execmem getcap getpgid getsched signull setrlimit };
  allowcom -sig init c; #allow dumpstate init:process sigchld;
  allowcom -sig mediaserver o; #allow dumpstate mediaserver:process signal;
  allowcom -sig sdcardd o; #allow dumpstate sdcardd:process signal;
  allowcom -sig su c; #allow dumpstate su:process { siginh transition sigchld rlimitinh };
  allowcom -sig surfaceflinger o; #allow dumpstate surfaceflinger:process signal;
  allowcom -sig system_server o; #allow dumpstate system_server:process signal;
  allowdev -pts devpts r;
allowdev -pts devpts w;

  allowdev -root /dev;
  allowfs qtaguid_proc  r,s,x,w;
  allowfs sysfs  w,r,s,x;
  allownet -protocol raw use;
  allowpriv cap2_syslog;
  allowpriv cap_chown;
  allowpriv cap_dac_override;
  allowpriv cap_fowner;
  allowpriv cap_fsetid;
  allowpriv cap_setgid;
  allowpriv cap_setuid;
  allowpriv cap_sys_resource;
  allowpriv execmem;
  allowpriv getsecattr;
  allowpriv getsecurity;
  allowpriv klog_read;
  allowpriv netlink;
  allowpriv part_relabel;
  allowpriv relabel;
  allowpriv setsecurity;
  allowsvc * f ;
  allowsvc -name servicemanager l ;
  allowsvc -name system_app_service f ;
  allowsvc DockObserver f ;
  allowsvc SurfaceFlinger f ;
  allowsvc accessibility f ;
  allowsvc account f ;
  allowsvc activity f ;
  allowsvc alarm f ;
  allowsvc android.hardware.fingerprint.IFingerprintDaemon f ;
  allowsvc android.security.keystore f ;
  allowsvc appops f ;
  allowsvc appwidget f ;
  allowsvc assetatlas f ;
  allowsvc audio f ;
  allowsvc backup f ;
  allowsvc battery f ;
  allowsvc batteryproperties f ;
  allowsvc batterypropreg f ;
  allowsvc batterystats f ;
  allowsvc bluetooth f ;
  allowsvc bluetooth_manager f ;
  allowsvc carrier_config f ;
  allowsvc clipboard f ;
  allowsvc com.android.net.IProxyService f ;
  allowsvc common_time.clock f ;
  allowsvc common_time.config f ;
  allowsvc commontime_management f ;
  allowsvc connectivity f ;
  allowsvc consumer_ir f ;
  allowsvc content f ;
  allowsvc country_detector f ;
  allowsvc cpuinfo f ;
  allowsvc dbinfo f ;
  allowsvc device_policy f ;
  allowsvc deviceidle f ;
  allowsvc devicestoragemonitor f ;
  allowsvc diskstats f ;
  allowsvc display f ;
  allowsvc display.qservice f ;
  allowsvc dreams f ;
  allowsvc drm.drmManager f ;
  allowsvc dropbox f ;
  allowsvc ethernet f ;
  allowsvc fingerprint f ;
  allowsvc gfxinfo f ;
  allowsvc graphicsstats f ;
  allowsvc hardware f ;
  allowsvc hdmi_control f ;
  allowsvc imms f ;
  allowsvc ims f ;
  allowsvc input f ;
  allowsvc input_method f ;
  allowsvc inputflinger f ;
  allowsvc iphonesubinfo f ;
  allowsvc iphonesubinfo2 f ;
  allowsvc iphonesubinfo_msim f ;
  allowsvc isms f ;
  allowsvc isms2 f ;
  allowsvc isms_msim f ;
  allowsvc isub f ;
  allowsvc jobscheduler f ;
  allowsvc launcherapps f ;
  allowsvc location f ;
  allowsvc lock_settings f ;
  allowsvc media.audio_flinger f ;
  allowsvc media.audio_policy f ;
  allowsvc media.camera f ;
  allowsvc media.camera.proxy f ;
  allowsvc media.log f ;
  allowsvc media.player f ;
  allowsvc media.radio f ;
  allowsvc media.resource_manager f ;
  allowsvc media.sound_trigger_hw f ;
  allowsvc media_projection f ;
  allowsvc media_router f ;
  allowsvc media_session f ;
  allowsvc meminfo f ;
  allowsvc midi f ;
  allowsvc mount f ;
  allowsvc netpolicy f ;
  allowsvc netstats f ;
  allowsvc network_management f ;
  allowsvc network_score f ;
  allowsvc nfc f ;
  allowsvc notification f ;
  allowsvc package f ;
  allowsvc permission f ;
  allowsvc persistent_data_block f ;
  allowsvc phone f ;
  allowsvc phone1 f ;
  allowsvc phone2 f ;
  allowsvc phone_msim f ;
  allowsvc power f ;
  allowsvc print f ;
  allowsvc processinfo f ;
  allowsvc procstats f ;
  allowsvc radio.phone f ;
  allowsvc radio.phonesubinfo f ;
  allowsvc radio.sms f ;
  allowsvc restrictions f ;
  allowsvc rttmanager f ;
  allowsvc samplingprofiler f ;
  allowsvc scheduling_policy f ;
  allowsvc search f ;
  allowsvc sensorservice f ;
  allowsvc serial f ;
  allowsvc servicediscovery f ;
  allowsvc simphonebook f ;
  allowsvc simphonebook2 f ;
  allowsvc simphonebook_msim f ;
  allowsvc sip f ;
  allowsvc statusbar f ;
  allowsvc task f ;
  allowsvc telecom f ;
  allowsvc telephony.registry f ;
  allowsvc textservices f ;
  allowsvc trust f ;
  allowsvc tv_input f ;
  allowsvc uimode f ;
  allowsvc updatelock f ;
  allowsvc usagestats f ;
  allowsvc usb f ;
  allowsvc user f ;
  allowsvc vibrator f ;
  allowsvc voiceinteraction f ;
  allowsvc wallpaper f ;
  allowsvc webviewupdate f ;
  allowsvc wifi f ;
  allowsvc wifip2p f ;
  allowsvc wifiscanner f ;
  allowsvc window f ;
  allowtmp -fs tmpfs -name auto r,w;
  inline "allow dumpstate debugfs:file { read lock ioctl open getattr };" #path_list: 
  inline "allow dumpstate domain:dir { read search ioctl open getattr };" #path_list: 
  inline "allow dumpstate domain:file { read lock ioctl open getattr };" #path_list: 
  inline "allow dumpstate domain:lnk_file { read lock ioctl open getattr };" #path_list: 
  inline "allow dumpstate dumpstate:dir { read search ioctl open getattr };" #path_list: 
  inline "allow dumpstate dumpstate:file { read lock getattr write ioctl open append };" #path_list: 
  inline "allow dumpstate dumpstate:lnk_file { read lock ioctl open getattr };" #path_list: 
  inline "allow dumpstate procrank:process transition;"
  inline "allow dumpstate pstorefs:dir { read search ioctl open getattr };" #path_list: 
  inline "allow dumpstate pstorefs:file { read lock ioctl open getattr };" #path_list: 
  inline "allow dumpstate su:process transition;"
  inline "allow dumpstate vdc:process transition;"
}

